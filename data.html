<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Sobremesa Digital</title>

<link rel="icon" href="favicon.ico" type="image/ico" sizes="16x16">


<link rel="stylesheet" type="text/css" href="basico.css">

<link rel="stylesheet" type="text/css" href="texto.css">

<style>
	.node {
		cursor: pointer;
	}

   .node circle {
        fill: #ffff;
        stroke: #c1c1c1;
        stroke-width: 6px;
    }
	

	.found {
		fill: #ff4136;
		stroke: #ff4136;
	}
	 .node text {
	font-family: 'Lora', serif;
	font-size: 12px;
	/*line-height: 200%; */

        color: #919191
    }
	   .link {
        fill: none;
        stroke: #ccc;
        stroke-width: 1.5px;
        opacity: 0.6;
  
    }
	
	/*Just to ensure the select2 box is "glued" to the top*/
	.search {
	color: #333333;
	width: 30%;
	float: centred;
	}
	
	* {
    box-sizing: border-box;
}
	
	.column {
	float: left;
	width: 50%;
	padding: 10px;
	height: 300px; /* Should be removed. Only for demonstration */
	
}

/* Clear floats after the columns */
.row:after {
    content: "";
    display: table;
    clear: both;
}
	
	
	
svg {
  display: block;
  margin: auto;
}



.contenido {
	width: 90%;
	padding: 20px;
	float: centered;	
	
}	
	
	
	
	
	
/* 2 columnas	
	
	
	
	* {
  box-sizing: border-box;
}

/* Create two equal columns that floats next to each other */
.column {
	float: left;
	width: 30%;
	height: auto;
	padding: 0px;
	margin-top: 30px;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

/* Responsive layout - makes the two columns stack on top of each other instead of next to each other */
@media screen and (max-width: 600px) {
  .column {
    width: 100%;
  }
}
	
	
	
	

		
	
	
a:visited {
	color: #666666;

}
a:link {
	color: #666666;
}
a:hover {
	color: #666666;
}
a:active {
	color: #666666;
}
</style>










</head>

<body class="oneColLiqCtrHdr">

<div id="container"> 
  
  
  
<!-- menu --> 
  <ul>
 
 
  <li class="dropdown">
    <a href="javascript:void(0)" class="dropbtn">Prototipo</a>
    <div class="dropdown-content">
      <a href="instalacion.html">Instalación</a>
      <a href="texto.html">Texto</a>
      <a href="data.html">Visualización de datos</a>
      <a href="http://54.175.193.171:4200">Imagen</a>
    </li>
    
   
   
  <li class="dropdown">
    <a href="javascript:void(0)" class="dropbtn">Proyecto</a>
    <div class="dropdown-content">
      <a href="about.html">Acerca de</a>
       <a href="proceso.html">Proceso</a>
      <a href="equipo.html">Equipo</a>
      

    </li>
       
    
   <li class="dropdown"><a href="index.html">Inicio</a></li>
   
  </li>
</ul>

 
    <!-- end menu -->
 
 
 
 
 
 
   </div>
 
 
 
 
<div id="header"> <!-- end #header --></div>
  


  <div id="mainContent">
  
  <nav class="floating-menu2"><img src="img/Sin título-1.png" width="79" height="193" /></nav>
  
  
  <div align="left">
  

  <p>
<span class="style1">*// Visualización de datos </span></p>


 <p class="style2">Estas visualizaciones representan los objetos en un ejercicio de lectura distante (F. Moretti), en el que estos se analizan como dato utilizando la metodología de tareas y descubrimientos de T. Munzner; <span id="resaltador">se obtienen algunos hallazgos</span> sobre los objetos en la novela <span id="resaltador">y se plantea una nueva hipótesis</span> sobre la importación de muebles y bienes de lujo a Bogotá en el siglo XIX.

</p>

  
  <div class="row">
  
  
  
  <div class="column">
     
  
  <hr>
   <p><span class="style5">Categorías </span>
        </p>
    </p>
    <p>Para definir las categorías de objetos presentes en la novela, se decidió  indagar archivos de prensa que evidencian anuncios publicitarios del almacén R. Silva e Hijo; este almacén pertenecía a la familia del autor. <span id="resaltador">De este proceso resultaron las categorías: muebles y decoración, vestuario, joyería, instrumentos.</span><br />
      <img src="img/iconos.png" width="304" height="107" /></p>
 
  <hr>
 
  </div>
  
  
  
  <div class="column" style="height: auto; margin-top: 30px; width: 70%;">
  
  <p align="right"><img src="img/periodico.jpg" width="652" height="321" /></p>
  
 
 
  
  </div>
  
   

  
 
  </div>
</div>
  
  
  
  
 
 
  <p align="left">
<span class="style5">¿Cuáles son los objetos? </span></p>


<p align="left">La primera tarea del proyecto de visualización consiste en presentar el inventario total de objetos, organizado por categorías, según cada uno de los días del diario de Fernandez. Se propone una visualización de árbol colapsible en D3, que permite al usuario interactuar con los contenidos en una estructura jerárquica con los siguientes niveles: diario - día  - categoría de objeto - descripción del objeto. Adicionalmente se propone la implementación de un buscador que permite hacer la busqueda de manera inversa, partiendo del objeto (en orden alfabético) al diario.</p>
<div align="left"><span id="resaltador">A primera vista se evidencian los días que tienen objetos que se enmarcan en las categorías propuestas. En contraste se evidecian también los días que no incluyen este tipo de objetos. Se puede indagar en cada día y en cada objeto de manera manual e intuitiva.</span>
    </p>
</div>
<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/select2/3.5.0/select2.min.css"></link>

<p>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/select2/3.5.0/select2.min.js"></script>
</p>
<p>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
  <!-- This will be attached to select2, only static element on the page -->
</p>
<div id="search"></div>

<!-- Main -->
<script type="text/javascript">

	//basically a way to get the path to an object
	function searchTree(obj,search,path){
		if(obj.name === search){ //if search is found return, add the object to the path and return it
			path.push(obj);
			return path;
		}
		else if(obj.children || obj._children){ //if children are collapsed d3 object will have them instantiated as _children
			var children = (obj.children) ? obj.children : obj._children;
			for(var i=0;i<children.length;i++){
				path.push(obj);// we assume this path is the right one
				var found = searchTree(children[i],search,path);
				if(found){// we were right, this should return the bubbled-up path from the first if statement
					return found;
				}
				else{//we were wrong, remove this parent from the path and continue iterating
					path.pop();
				}
			}
		}
		else{//not the right object, return false so it will continue to iterate in the loop
			return false;
		}
	}

	function extract_select2_data(node,leaves,index){
	        if (node.children){
	            for(var i = 0;i<node.children.length;i++){
	                index = extract_select2_data(node.children[i],leaves,index)[0];
	            }
	        }
	        else {
	            leaves.push({id:++index,text:node.name});
	        }
	        return [index,leaves];
	}
	
	
	 var colores = {
            "muebles-deco": "#66CCCC",
            "joyería": "#FF9999",
            "vestuario": "#F0CA66",
            "instrumentos": "#CC99CC"
        }
	

	var div = d3.select("body")
		.append("div") // declare the tooltip div
		.attr("class", "tooltip")
		.style("opacity", 0);

	var margin = {top: 20, right: 120, bottom: 20, left: 120},
		width = 960 - margin.right - margin.left,
		height = 800 - margin.top - margin.bottom;

	var i = 0,
		duration = 750,
		root,
		select2_data;

	var diameter = 960;

	var tree = d3.layout.tree()
		.size([height, width]);

	var diagonal = d3.svg.diagonal()
		.projection(function(d) { return [d.y, d.x]; });

	var svg = d3.select("body").append("svg")
		.attr("width", width + margin.right + margin.left)
		.attr("height", height + margin.top + margin.bottom)
	  	.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

	//recursively collapse children
	function collapse(d) {
		if (d.children) {
			d._children = d.children;
			d._children.forEach(collapse);
			d.children = null;
		}
	}

	// Toggle children on click.
	function click(d) {
		if (d.children) {
			d._children = d.children;
			d.children = null;
	  	}
	  	else{
			d.children = d._children;
			d._children = null;
	  	}
		update(d);
	}

	function openPaths(paths){
		for(var i =0;i<paths.length;i++){
			if(paths[i].id !== "1"){//i.e. not root
				paths[i].class = 'found';
				if(paths[i]._children){ //if children are hidden: open them, otherwise: don't do anything
					paths[i].children = paths[i]._children;
	    			paths[i]._children = null;
				}
				update(paths[i]);
			}
		}
	}

	d3.json("flare.json", function(error,values){
		root = values;
		select2_data = extract_select2_data(values,[],0)[1];//I know, not the prettiest...

		select2_data.sort(function(a,b){
			return d3.descending(a.text,b.text);
		});

		root.x0 = height / 2;
		root.y0 = 0;
		root.children.forEach(collapse);
		update(root);
		//init search box
		$("#search").select2({
			data: select2_data,
			containerCssClass: "search"
		});
	});
	//attach search box listener
	$("#search").on("select2-selecting", function(e) {
		var paths = searchTree(root,e.object.text,[]);
		if(typeof(paths) !== "undefined"){
			openPaths(paths);
		}
		else{
			alert(e.object.text+" not found!");
		}
	})

	d3.select(self.frameElement).style("height", "800px");

	function update(source) {
		// Compute the new tree layout.
		var nodes = tree.nodes(root).reverse(),
		links = tree.links(nodes);

		// Normalize for fixed-depth.
		nodes.forEach(function(d) { d.y = d.depth * 180; });

		// Update the nodesâ€¦
		var node = svg.selectAll("g.node")
			.data(nodes, function(d) { return d.id || (d.id = ++i); });

		// Enter any new nodes at the parent's previous position.
		var nodeEnter = node.enter().append("g")
			.attr("class", "node")
		.attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
		.on("click", click);

		nodeEnter.append("circle")
		.attr("r", 1e-6)
		.style("fill", function(d) { return d._children ? "lightsteelblue" : "#fff"; });

		nodeEnter.append("text")
			.attr("x", function(d) { return d.children || d._children ? -10 : 10; })
			.attr("dy", ".35em")
			.attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
			.text(function(d) { return d.name; })
			.style("fill-opacity", 1e-6);

		// Transition nodes to their new position.
		var nodeUpdate = node.transition()
			.duration(duration)
			.attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });

		nodeUpdate.select("circle")
			.attr("r", 4.5)
			.style("fill", function(d) {
				if(d.class === "found"){
					return getParent(d);
					return "#7D344A"; //color selección
				}
				else if(d._children){
					return "lightsteelblue";
				}
				else{
					return "#fff";
				}
			})
			.style("stroke", function(d) {
				if(d.class === "found"){
					return "#7D344A"; //color selección
				}else{
					return getParent(d);
				}
		});

		nodeUpdate.select("text")
			.style("fill-opacity", 1);

		// Transition exiting nodes to the parent's new position.
		var nodeExit = node.exit().transition()
			.duration(duration)
			.attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
			.remove();

		nodeExit.select("circle")
			.attr("r", 1e-6);

		nodeExit.select("text")
			.style("fill-opacity", 1e-6);

		// Update the linksâ€¦
		var link = svg.selectAll("path.link")
			.data(links, function(d) { return d.target.id; });

		// Enter any new links at the parent's previous position.
		link.enter().insert("path", "g")
			.attr("class", "link")
			.attr("d", function(d) {
				var o = {x: source.x0, y: source.y0};
				return diagonal({source: o, target: o});
			});

		// Transition links to their new position.
		link.transition()
			.duration(duration)
			.attr("d", diagonal)
			.style("stroke",function(d){
				if(d.target.class==="found"){
					return "#7D344A";  //color selección
				}
			});

		// Transition exiting nodes to the parent's new position.
		link.exit().transition()
			.duration(duration)
			.attr("d", function(d) {
				var o = {x: source.x, y: source.y};
				return diagonal({source: o, target: o});
			})
			.remove();

		// Stash the old positions for transition.
		nodes.forEach(function(d) {
			d.x0 = d.x;
			d.y0 = d.y;
		  });
	}
	
	
		// funcion para cambiar los colores
	
	
        function getParent(node) {
            var keys = Object.keys(colores);
            console.log('keys', keys);
            var item = keys.find(function (d) {
                console.log('d.name', d.name);
                console.log('node.name', node.name);
                return d == node.name.toLowerCase();
            });
            
                console.log('item', item);
            if (item) {
                return colores[item];
            } else {
                if (node.parent) {
                    return getParent(node.parent);
                }
                else {
				 
				 // color de diario y días
                    return '#b7b7b7';
                }
            }
        }
	
</script>


 </div>
<!-- end #mainContent -->
<div id="parrafo">
  
   </div> <!-- end parrafo -->
  
 
<div id="mainContent2">
    <div align="left">
   
        <p align="left"><span class="style5">Distribución de objetos en los 36 días del diario</span>
     <p>La seguda tarea del proyecto es buscar patrones existentes en la presencia de objetos a lo largo de la narración. Para esto se propone una visualización de árbol radial que permite presentar la distribución total de objetos y sus categorías, de manera secuencial.
 </p>
  <p>
    <span id="resaltador">Esta gráfica evidencia la presencia constante y mayoritaria de objetos pertenecientes a la categoría muebles y decoración, seguida por los pertenecientes a la categoría vestuario. La distribución total es de carácter homogéneo y presenta algunas simetrías.</span> <span id="resaltador_azul"><span class="style2"><a href="vis.html" class="style4" >ZOOM</a></span><a href="vis.html" > <span class="style4"><strong>+</strong></span></a></span></p>
    
   <img src="img/radial-color final.png" width="859" height="795" /></p>
 

  
  
  <div class="row">
 
 
  <div class="column">
     
  
  <hr>
 <p align="left"> <span class="style5">Muebles y objetos decorativos, por ciudad</span>  </p>
    <p align="left">Una tercera visualización busca evidenciar la presencia de objetos de la categoría con mayor presencia de elementos: "muebles - decoración", según la ciudad desde donde se escribe la entrada del diario.</p>

  <p>  Sí bien Fernandez recorre en su mayoría ciudades Suizas, son París y Londres las ciudades con más objetos de esta categoría. <span id="resaltador"> A partir de esta evidencia se plantea una nueva hipótesis en la que se pregunta si el origen de los muebles importados a Bogotá en el siglo XIX eran en su mayoría ingleses y franceses.</span></p>
 
    <hr>
 
  </div>
 
 
  <div class="column" style="height: auto; margin-top: 30px; width: 70%;">
  
  
  <p><img src="img/data ciudad.png" width="707" height="445" /></p>
  
 
 
  
  </div>
  
   

 
  </div>
</div>
 
  
  
  
 
  
</div>
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  <div id="footer">
    <!-- end #footer -->
  </div>
<!-- end #container -->
</body>
</html>
